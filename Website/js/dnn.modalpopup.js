(function(a,b){a.dnnModal={load:function(){try{if(parent.location.href!==undefined){var j=parent;var g=j.parent;if(typeof(g.$find)!="undefined"){if(location.href.indexOf("popUp")==-1||j.location.href.indexOf("popUp")>-1){var c=j.jQuery("#iPopUp");var f=c.dialog("option","refresh");var h=c.dialog("option","closingUrl");var d=c.dialog("option","minWidth");var i=c.dialog("option","minHeight");var k=c.dialog("option","showReturn");if(!h){h=location.href}if(c.dialog("isOpen")===true){c.dialog("option",{close:function(l,m){dnnModal.refreshPopup({url:h,width:d,height:i,showReturn:k,refresh:f})}}).dialog("close")}}else{j.jQuery("#iPopUp").dialog({autoOpen:false,title:document.title})}}}return true}catch(e){return false}},show:function(c,o,l,e,h,k){var j=b("#iPopUp");if(j.length==0){j=b('<iframe id="iPopUp" src="about:blank" scrolling="auto" frameborder="0"></iframe>');b(document.body).append(j)}else{j.attr("src","about:blank")}b(document).find("html").css("overflow","hidden");var g;if(b.ui.dialog.prototype.options.beforeClose){g=b.ui.dialog.prototype.options.beforeClose}j.dialog({modal:true,autoOpen:true,dialogClass:"dnnFormPopup",position:"center",minWidth:e,minHeight:l,maxWidth:1920,maxHeight:1080,resizable:true,closeOnEscape:true,refresh:h,showReturn:o,closingUrl:k,beforeClose:function(p,q){if(g){g.call(this,p,q)}if(b(".ui-widget-overlay").length>0){dnn.removeIframeMask(b(".ui-widget-overlay")[0])}},close:function(p,q){dnnModal.closePopUp(h,k)}}).width(e-11).height(l-11);var n=dnn.addIframeMask(b(".ui-widget-overlay")[0]);if(n!=null){n.style.zIndex=1}if(j.parent().find(".ui-dialog-title").next("a.dnnModalCtrl").length===0){var d=b('<a class="dnnModalCtrl"></a>');j.parent().find(".ui-dialog-titlebar-close").wrap(d);var i=b('<a href="#" class="dnnToggleMax"><span>Max</span></a>');j.parent().find(".ui-dialog-titlebar-close").before(i);i.click(function(r){r.preventDefault();var s=b(a),p,q;if(j.data("isMaximized")){p=j.data("height");q=j.data("width");j.data("isMaximized",false)}else{j.data("height",j.dialog("option","minHeight")).data("width",j.dialog("option","minWidth")).data("position",j.dialog("option","position"));p=s.height()-46;q=s.width()-40;j.data("isMaximized",true)}j.dialog({height:p,width:q});j.dialog({position:"center"})})}var f=function(){var p=b('<div class="dnnLoading"></div>');p.css({width:j.width(),height:j.height()});j.before(p)};var m=function(){j.prev(".dnnLoading").remove()};f();j[0].src=c;j.bind("load",function(){m()});if(o.toString()=="true"){return false}},closePopUp:function(e,d){var f=parent;var c=f.jQuery("#iPopUp");if(typeof e==="undefined"||e==null){e=true}if(e.toString()=="true"){if(typeof d==="undefined"||d==""){d=f.location.href}f.location.href=d;a.dnnModal.pageUnloaded=true;if(b(".ui-widget-overlay").length>0){dnn.removeIframeMask(b(".ui-widget-overlay")[0])}c.hide()}else{c.dialog("option","close",null).dialog("close")}b(f.document).find("html").css("overflow","")},refreshPopup:function(c){var d=parent;var e=d.parent;if(d.location.href!==e.location.href&&d.location.href!==c.url){e.dnnModal.show(c.url,c.showReturn,c.height,c.width,c.refresh,c.closingUrl)}else{dnnModal.closePopUp(c.refresh,c.url)}}};a.dnnModal.load()}(window,jQuery));